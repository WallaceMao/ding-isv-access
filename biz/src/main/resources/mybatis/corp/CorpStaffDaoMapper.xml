<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dingtalk.isv.access.biz.corp.dao.CorpStaffDao">

    <resultMap type="com.dingtalk.isv.access.biz.corp.model.StaffDO" id="corpStaffMap">
        <id property="id" column="id" />
        <result property="gmtCreate" column="gmt_create" />
        <result property="gmtModified" column="gmt_modified" />
        <result property="corpId" column="corp_id" />
        <result property="userId" column="user_id" />
        <result property="name" column="name" />
        <result property="tel" column="tel" />
        <result property="workPlace" column="work_place" />
        <result property="remark" column="remark" />
        <result property="mobile" column="mobile" />
        <result property="email" column="email" />
        <result property="active" column="active" />
        <result property="orderInDepts" column="order_in_depts" />
        <result property="isAdmin" column="is_admin" />
        <result property="isBoss" column="is_boss" />
        <result property="dingId" column="ding_id" />
        <result property="isLeaderInDepts" column="is_leader_in_depts" />
        <result property="isHide" column="is_hide" />
        <result property="department" column="department" />
        <result property="position" column="position" />
        <result property="avatar" column="avatar" />
        <result property="jobnumber" column="jobnumber" />
        <result property="extattr" column="extattr" />
        <result property="isSys" column="is_sys" />
        <result property="sysLevel" column="sys_level" />
    </resultMap>

    <sql id="select-all-fields">
            id,
            gmt_create,
            gmt_modified,
            corp_id,
            user_id,
            `name`,
            tel,
            work_place,
            remark, 
            mobile, 
            email, 
            active, 
            order_in_depts, 
            is_admin, 
            is_boss, 
            ding_id, 
            is_leader_in_depts,
            is_hide, 
            department, 
            `position`, 
            avatar, 
            jobnumber, 
            extattr, 
            is_sys, 
            sys_level
    </sql>

    <insert id="saveOrUpdateCorpStaff" useGeneratedKeys="true" keyProperty="id">
        insert into isv_corp (
            gmt_create,
            gmt_modified,
            corp_id,
            user_id,
            `name`,
            tel,
            work_place,
            remark, 
            mobile, 
            email, 
            active, 
            order_in_depts, 
            is_admin, 
            is_boss, 
            ding_id, 
            is_leader_in_depts,
            is_hide, 
            department, 
            `position`, 
            avatar, 
            jobnumber, 
            extattr, 
            is_sys, 
            sys_level
        )values(
            now(),
            now(),
            #{corpId},
            #{userId},
            #{name},
            #{tel},
            #{workPlace},
            #{remark}, 
            #{mobile}, 
            #{email}, 
            #{active}, 
            #{orderInDepts}, 
            #{isAdmin}, 
            #{isBoss}, 
            #{dingId}, 
            #{isLeaderInDepts},
            #{isHide}, 
            #{department}, 
            #{position}, 
            #{avatar}, 
            #{jobnumber}, 
            #{extattr}, 
            #{isSys}, 
            #{sysLevel}
        )ON DUPLICATE KEY UPDATE
        gmt_modified=now(),
        `name`=#{name},
        tel=#{tel},
        work_place#{workPlace},
        remark=#{remark},
        mobile=#{mobile},
        email=#{email},
        active=#{active},
        order_in_depts=#{orderInDepts},
        is_admin=#{isAdmin},
        is_boss=#{isBoss},
        is_leader_in_depts=#{isLeaderInDepts},
        is_hide=#{isHide},
        department=#{department},
        `position`=#{position},
        avatar=#{avatar},
        jobnumber=#{jobnumber},
        extattr=#{extattr},
        is_sys=#{isSys},
        sys_level=#{sysLevel}
    </insert>



    <select id="getStaffByCorpIdAndUserId" resultMap="corpStaffMap">
        SELECT <include refid="select-all-fields"/>  FROM isv_corp_staff
        <![CDATA[
			WHERE corp_id=#{corpId} and user_id=#{userId}
		 ]]>
    </select>

</mapper>